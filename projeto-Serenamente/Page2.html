<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Serenamente - Doa√ß√µes</title>
    <link rel="stylesheet" href="stylePage2.css">
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" 
     integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" 
     crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <nav class="cabeca">
        <div class="icon_nav">
            <a href="#"><img class="icon_img" src="./imagens/o-email.png" alt="e-mail"></a>
            <a href="#"><img class="icon_img" src="./imagens/localizacao.png" alt="Localiza√ß√£o"></a>
            <a href="#"><img class="icon_img" src="./imagens/whatsapp.png" alt="Contato"></a>
        </div>
        <h1>Serenamente</h1>
        <div class="icon_nav">
            <a href="#"><img class="icon_img" src="./imagens/linkedin.png" alt="Linkedin"></a>
            <a href="#"><img class="icon_img" src="./imagens/facebook.png" alt="Facebook"></a>
            <a href="#"><img class="icon_img" src="./imagens/instagram.png" alt="Instagram"></a>
            <a href="serenamente.html"><img class="icon2_img" src="./imagens/botao-home.png" alt="Home"></a>
        </div>
        
    </nav>
    
    <main>
        <h1>Por Que Ser Volunt√°rio em uma ONG de Apoio √† Ansiedade?</h1>
        <p><b>Ser volunt√°rio em uma ONG que ajuda pessoas com ansiedade √© mais do que um ato de generosidade ‚Äì √© uma oportunidade de transformar vidas, incluindo a sua.</b></p>
        <p>üíô Voc√™ Pode Fazer a Diferen√ßa
        A ansiedade afeta milh√µes de pessoas, muitas delas sem acesso a apoio adequado. Como volunt√°rio, voc√™ oferece escuta ativa, acolhimento e recursos que podem aliviar o sofrimento emocional e ajudar na recupera√ß√£o.
        </p>
        <p>
            üå± Crescimento Pessoal
            Ao ajudar outros, voc√™ desenvolve habilidades como empatia, comunica√ß√£o e resili√™ncia. Aprende sobre sa√∫de mental, autocuidado e fortalece sua pr√≥pria intelig√™ncia emocional.
        </p>
        <p>
            ü§ù Comunidade e Conex√µes
            Trabalhar em uma ONG conecta voc√™ a pessoas com valores semelhantes, criando la√ßos significativos e uma rede de apoio m√∫tuo.
        </p>
        <p>
            üåç Impacto Social
            Sua contribui√ß√£o ajuda a reduzir o estigma em torno da sa√∫de mental, promovendo uma sociedade mais consciente e solid√°ria. 
        </p>
        <p>
            ‚ù§Ô∏è A Recompensa √© Imediata
            Ver algu√©m recuperar a esperan√ßa e o bem-estar por meio do seu apoio √© uma das experi√™ncias mais gratificantes que existem.
        </p>
        <p>
            Seja volunt√°rio e ajude a construir um mundo com menos ansiedade e mais acolhimento! üåü</p>
        <h4 class="Cadastro">Formul√°rio de voluntario</h4>
        <div id="alerta"></div>
        
        <form id="formCadastro">
            <div class="form-group">
                <label for="codigo">C√≥digo</label>
                <input type="text" id="codigo" name="codigo" readonly>
            </div>
            
            <div class="form-group">
                <label for="nome">Nome Completo</label>
                <input type="text" id="nome" name="nome" required>
            </div>
            
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>

             <div class="form-group">
            <label for="senha">Senha</label>
            <div class="password-container">
                <input type="password" id="senha" name="senha" required>
                <button type="button" class="toggle-password" id="togglePassword">
                    <img src="./imagens/olho.png" alt="Mostrar senha" width="20">
                </button>
            </div>
        </div>
            
            <div class="form-group">
                <label for="data_nascimento">Data Nascimento</label>
                <input type="text" id="data_nascimento" name="data_nascimento" required>
            </div>
            
            <div class="form-group">
                <label for="forma_pagamento">Forma de Pagamento</label>
                <select id="forma_pagamento" name="forma_pagamento" required>
                    <option value="">Selecione...</option>
                    <option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option>
                    <option value="Cart√£o de D√©bito">Cart√£o de D√©bito</option>
                    <option value="PIX">PIX</option>
                    <option value="Boleto Banc√°rio">Boleto Banc√°rio</option>
                    <option value="Transfer√™ncia Banc√°ria">Transfer√™ncia Banc√°ria</option>
                </select>
            </div>
            
            <div class="button-group">
                <button class="b" type="button" id="btSalvar">Salvar </button>
                <button class="b" type="button" id="btAlterar">Alterar</button>
                <button class="b" type="button" id="btExcluir">Excluir</button>
            </div>
        </form>
        
        <h4 class="lista">Lista de volunt√°rios</h4>
        
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>C√≥digo</th>
                        <th>Nome</th>
                        <th>E-mail</th>
                        <th>senha</th>
                        <th>Data de Nascimento</th>
                        <th>Forma de Pagamento</th>
                    </tr>
                </thead>
                <tbody id="tabelaDados">
                    <!-- AQUI entra os dados - API -->
                </tbody>
            </table>
        </div>
    </main>
    
    <footer>
        &copy; Serenamente - Todos os direitos reservados
    </footer>
    
    <script>
        

        function carregarDados() {
            $.ajax({ 
                url : 'http://localhost/serenamenteApi/api/usuarios/' , //endpoint
                method: 'GET' , 
                dataType : 'json' ,
                success : function ( resposta  ) { 

                    const tabela = $('#tabelaDados') ;
                    tabela.empty() ; //limpa a tabela antes de adicionar novos dados

                    if ( resposta.erro ) {
                        tabela.html( '<tr><td colspan="4">Erro ao usar a API</td></tr>' ) ; 
                    } else if ( resposta.dados.length === 0 ) {
                        tabela.html( '<tr><td colspan="4">Tabela est√° vazia</td></tr>' ) ; 
                    } else {
                        resposta.dados.forEach(  function ( item ) { 
                            tabela.append(  
                                `<tr
                                        class="linha-dado"
                                        data-codigo="${item.id}"
                                        data-nome="${item.nome}"
                                        data-email="${item.email}"
                                        data-senha="${item.senha}"
                                        data-data_nascimento="${item.data_nascimento}"
                                        data-forma_pagamento="${item.forma_pagamento}"
                                    >
                                    <td> ${item.id} </td>
                                    <td> ${item.nome} </td>
                                    <td> ${item.email} </td>
                                    <td> ${item.senha} </td>
                                    <td> ${item.data_nascimento} </td>
                                    <td> ${item.forma_pagamento} </td>
                                </tr>`
                            ) ;

                        } ) ;
                    }

                 } ,
                error : function ( ) { 
                    $('#tabelaDados').html( '<tr><td colspan="4">Erro ao usar a API</td></tr>' ) ; 
                }
             }) ;
        }

        function alterarDados() {
            
            const dados = { 
                nome : $('#nome').val() ,
                email : $('#email').val() ,
                senha : $('#senha').val() ,
                data_nascimento : $('#data_nascimento').val() ,
                forma_pagamento : $('#forma_pagamento').val()
            } ;


            $.ajax ({
                url : 'http://localhost/serenamenteApi/api/usuarios/' + $('#codigo').val() , 
                method: 'PUT' ,
                contentType: 'application/json' ,
                data : JSON.stringify(dados) ,
                success: function ( resposta ) { 
                    if ( resposta.erro ) {
                        $('#alerta').html(`<strong>${resposta.mensagem}</strong>`) ;
                    } else {
                        $('#formCadastro')[0].reset() ; // Limpa o formul√°rio
                        carregarDados() ;
                        $('#alerta').html(`<strong>${resposta.mensagem}</strong>`) ;
                    }

                } ,
                error : function () { 
                    $('#alerta').html('<strong>Erro ao comunicar com a API</strong>') ;
                }
            }) ;
        }

        function excluirDados() {
            
            $.ajax ({
                url : 'http://localhost/serenamenteApi/api/usuarios/' + $('#codigo').val() , 
                method: 'DELETE' ,
                contentType: 'application/json' ,
                success: function ( resposta ) { 
                    if ( resposta.erro ) {
                        $('#alerta').html(`<strong>${resposta.mensagem}</strong>`) ;
                    } else {
                        $('#formCadastro')[0].reset() ; // Limpa o formul√°rio
                        carregarDados() ;
                        $('#alerta').html(`<strong>${resposta.mensagem}</strong>`) ;
                    }

                } ,
                error : function () { 
                    $('#alerta').html('<strong>Erro ao comunicar com a API</strong>') ;
                }
            }) ;
        }

        function inserirDados() {

            const dados = { 
                nome : $('#nome').val() ,
                email : $('#email').val() ,
                senha : $('#senha').val() ,
                data_nascimento : $('#data_nascimento').val() ,
                forma_pagamento : $('#forma_pagamento').val()
            } ;


            $.ajax ({
                url : 'http://localhost/serenamenteApi/api/usuarios' , 
                method: 'POST' ,
                contentType: 'application/json' ,
                data : JSON.stringify(dados) ,
                success: function ( resposta ) { 
                    if ( resposta.erro ) {
                        $('#alerta').html(`<strong>${resposta.mensagem}</strong>`) ;
                    } else {
                        $('#formCadastro')[0].reset() ; // Limpa o formul√°rio
                        carregarDados() ;
                        $('#alerta').html(`<strong>${resposta.mensagem}</strong>`) ;
                    }

                } ,
                error : function () { 
                    $('#alerta').html('<strong>Erro ao comunicar com a API</strong>') ;
                }
            }) ;
        }

        //Evento para preencher os campos ao clicar na linha
        $("#tabelaDados").on( 'click' , '.linha-dado'  , function () {
            $("#codigo").val(  $(this).data('codigo')  ) ;
            $("#nome").val(  $(this).data('nome')  ) ;
            $("#email").val(  $(this).data('email')  ) ;
            $("#senha").val(  $(this).data('senha')  ) ;
            $("#data_nascimento").val(  $(this).data('data_nascimento')  ) ;
            $("#forma_pagamento").val(  $(this).data('forma_pagamento')  ) ;
        }) ;

        //Ser√° feito apos o carregamento da p√°gina
        $(document) .ready( function () {   
            carregarDados() ;

            //Evento do bot√£o salvar
            $('#btSalvar').on( 'click' , function() { 
                inserirDados() ;
            }) ;

            //Evento do bot√£o alterar
            $('#btAlterar').on('click' , function() {
                alterarDados() ;
            }) ;

            //Evento do bot√£o excluir
            $('#btExcluir').on('click' , function() {
                excluirDados() ;
            });

        }) ; 

        // Evento para mostrar/esconder senha
        $('#togglePassword').on('click', function() {
            const senhaInput = $('#senha');
            const icon = $(this).find('img');
            
            if (senhaInput.attr('type') === 'password') {
                senhaInput.attr('type', 'text');
                icon.attr('src', './imagens/olho-fechado.png');
                icon.attr('alt', 'Ocultar senha');
            } else {
                senhaInput.attr('type', 'password');
                icon.attr('src', './imagens/olho.png');
                icon.attr('alt', 'Mostrar senha');
            }
        });

        

    </script>
</body>
</html>